<!-- concerts/templates/concerts/concert_edit.html -->

{% extends 'base.html' %}

{% block content %}
  <h1>Edit Concert: {{ concert.title }}</h1>

<hr>

<!-- ===================== -->
<!-- Core Concert Fields   -->
<!-- ===================== -->
<section>
  <h2>Concert Details</h2>

  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Save Changes</button>
  </form>

  <p>
    Don't see the venue you need?
    <a href="{% url 'venues:venue_add' %}?next={{ request.path }}">Add a new venue</a>
  </p>
</section>

<hr>


<!-- ==================== -->
<!-- People & Roles       -->
<!-- ==================== -->
<section>
  <h2>People & Roles</h2>

  <div
    id="concert-people-panel"
    hx-get="{% url 'concerts:concert_people_panel_hx' concert.pk %}"
    hx-trigger="load"
    hx-target="this"
    hx-swap="innerHTML"
  >
    <p class="opacity-70">Loading people & roles...</p>
  </div>
</section>

<!-- Person Creation Modal -->
<dialog id="person_modal" class="modal">
  <div class="modal-box">
    <h3 class="font-bold text-lg">Add New Person</h3>
    <div id="person-form-target">
      <p class="py-4 text-sm opacity-70">Loading person form...</p>
    </div>
    <div class="modal-action">
      <form method="dialog">
        <button class="btn">Close</button>
      </form>
    </div>
  </div>
</dialog>

<hr>


<!-- ==================== -->
<!-- Program              -->
<!-- ==================== -->
<section>
  <h2>Program</h2>

  {% if concert.program_items.exists %}
    <ol>
      {% for item in concert.program_items.all %}
        <li>
          <strong>{{ item.music.title }}</strong>
          {% if item.notes %}
            <br><small>{{ item.notes }}</small>
          {% endif %}
        </li>
      {% endfor %}
    </ol>
  {% else %}
    <p>No program items.</p>
  {% endif %}

  <p>
    <a href="{% url 'concerts:concert_program_edit' concert.pk %}">
      Add / change program items
    </a>
  </p>
</section>

<hr>

<!-- ======================= -->
<!-- Navigation              -->
<!-- ======================= -->
<nav>
  <a href="{% url 'concerts:concert_detail' concert.pk %}">
    View concert details
  </a>

  <a href="{% url 'concerts:concert_list' %}">
    Back to concert list
  </a>
</nav>

{% endblock %}
