<!-- organizations/templates/organizations/organization_list.html -->

{% extends "base.html" %}

{% block title %}Organizations{% endblock %}

{% block content %}
<h1>Organizations</h1>

<form method="get">
  <fieldset>
    <legend>Filters</legend>

    <!-- live search for name, via HTMX (no Alpine) -->
    <input
      type="search"
      name="q"
      placeholder="Search organizations..."
      value="{{ request.GET.q|default:'' }}"
      hx-get="{% url 'organizations:organization_list' %}"
      hx-trigger="keyup changed delay:300ms"
      hx-target="#organization-table"
      hx-push-url="true"
      hx-include="closest form"
    />

    <label>
      Active:
      <select name="active">
        <option value="active" {% if filters.active == 'active' %}selected{% endif %}>Active</option>
        <option value="inactive" {% if filters.active == 'inactive' %}selected{% endif %}>Inactive</option>
        <option value="all" {% if filters.active == 'all' %}selected{% endif %}>All</option>
      </select>
    </label>

    <label>
      Role:
      <select name="role">
        <option value="" {% if not filters.role %}selected{% endif %}>All roles</option>
        {% for role in role_types %}
          <option value="{{ role.id }}" {% if filters.role == role.id %}selected{% endif %}>{{ role.name }}</option>
        {% endfor %}
      </select>
    </label>

    <button type="submit">Apply</button>
  </fieldset>
</form>

<a href="{% url 'organizations:organization_add' %}">Add organization</a>

<div id="organization-table">
  {% include "organizations/_organization_table.html" %}
</div>
{% endblock %}
